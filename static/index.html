<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>A static page</title>
    <link rel="stylesheet" href="main.css">
</head>
<body>
<p contenteditable="true" id="room-title" class="title">Room title</p>
<p>
<select id="vote-select">
    <option value="0">0</option>
    <option value="1">1</option>
    <option value="2">2</option>
    <option value="3">3</option>
    <option value="5">5</option>
    <option value="8">8</option>
</select>
</p>
<p>
    <button id="vote-btn">Vote!</button>
</p>
<p>
    <ul id="messages"></ul>
</p>
</body>
<script>
    // Create WebSocket connection.
    var params = new URLSearchParams(window.location.search);
    var r = params.get("r");
    console.log("r param: " + r);
    var socket = new WebSocket('ws://' + window.location.hostname + ':12345/ws?r=' + r);
    // Connection opened
    socket.addEventListener('open', function (event) {
        // socket.send('hello');
    });
    // Listen for messages
    socket.addEventListener('message', function (event) {
        var li = document.createElement("LI");
        var text = document.createTextNode(event.data);
        li.appendChild(text);

        var ul = document.getElementById("messages");
        ul.insertBefore(li, ul.childNodes[0]);
        console.log('Message from server ', event.data);
    });
    var initButton = function () {
        // var voteButtons = document.getElementsByClassName("vot-btn");
        // for (var i = 0; i < voteButtons.length; i++) {
        //     voteButtons[i].addEventListener("click", send);
        // }
        var btn = document.getElementById("vote-btn");
        btn.addEventListener("click", function (ev) {
            var sel = document.getElementById("vote-select");
            var val = sel.options[sel.selectedIndex].value;
            socket.send("button pressed: " + val)
        })
    };
    var send = function (evt) {
    };

    initButton()
</script>
</html>